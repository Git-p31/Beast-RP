<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вход</title>
    <link rel="stylesheet" href="Login.css">
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
      import { getAuth, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCuA3YUjmuIYc5jtndT31uKk0YFIcEDqdc",
        authDomain: "beast-rp.firebaseapp.com",
        projectId: "beast-rp",
        storageBucket: "beast-rp.appspot.com",
        messagingSenderId: "1062355740105",
        appId: "1:1062355740105:web:d06245552fec9b0c9b7418",
        measurementId: "G-MQHJXE1GVV"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      document.addEventListener("DOMContentLoaded", () => {
        const loginForm = document.getElementById("login-form");
        const resetForm = document.getElementById("reset-form");
        const resetPasswordLink = document.getElementById("reset-password-link");
        const backToLoginLink = document.getElementById("back-to-login-link");

        loginForm.addEventListener("submit", (event) => {
          event.preventDefault();

          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          signInWithEmailAndPassword(auth, username, password)
            .then((userCredential) => {
              const user = userCredential.user;
              console.log("Logged in:", user.email);
              window.location.href = "account.html";
            })
            .catch((error) => {
              console.error("Error logging in:", error);
              alert("Ошибка входа. Проверьте свои данные.");
            });
        });

        resetPasswordLink.addEventListener("click", (event) => {
          event.preventDefault();
          loginForm.style.display = "none";
          resetForm.style.display = "block";
        });

        backToLoginLink.addEventListener("click", (event) => {
          event.preventDefault();
          resetForm.style.display = "none";
          loginForm.style.display = "block";
        });

        resetForm.addEventListener("submit", (event) => {
          event.preventDefault();

          const email = document.getElementById("reset-email").value;

          if (email) {
            sendPasswordResetEmail(auth, email)
              .then(() => {
                alert("Ссылка для сброса пароля отправлена на ваш email.");
                resetForm.style.display = "none";
                loginForm.style.display = "block";
              })
              .catch((error) => {
                console.error("Error sending password reset email:", error);
                alert("Ошибка отправки ссылки для сброса пароля.");
              });
          }
        });
      });
    </script>
</head>
<body>
    <header>
        <a href="index.html" class="back-button">Назад на главную</a>
    </header>
    <main>
        <div class="form-container">
            <form id="login-form">
                <h1>Вход</h1>
                <label for="server-select">Выберите сервер:</label>
                <select id="server-select" class="field">
                    <option value="server1">Сервер 1</option>
                    <option value="server2">Сервер 2</option>
                    <option value="server3">Сервер 3</option>
                </select>
                <label for="username">Мой ник нейм:</label>
                <input type="text" id="username" class="field" required>
                <label for="password">Пароль:</label>
                <input type="password" id="password" class="field" required>
                <button type="submit" class="button">Войти</button>
                <p><a href="#" id="reset-password-link">Забыли пароль?</a></p>
                <p><a href="Registration.html" id="register-link">Регистрация</a></p>
            </form>
            <form id="reset-form" style="display:none;">
                <h1>Сброс пароля</h1>
                <label for="reset-email">Введите ваш email:</label>
                <input type="email" id="reset-email" class="field" required>
                <button type="submit" class="button">Отправить ссылку для сброса</button>
                <p><a href="#" id="back-to-login-link">Назад</a></p>
            </form>
        </div>
    </main>
</body>
</html>
